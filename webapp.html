<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>COUGAR RUN | THE PROVO TRIALS</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Oswald:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --byu-blue: #002E5D; --byu-royal: #0062B8; --gold: #ef9e11; --grass: #4caf50; }
        body {
            background-color: #d1d9e0;
            color: var(--byu-blue);
            font-family: 'Bungee', cursive;
            margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; overflow: hidden;
        }
        /* THE PROVO TRIALS HEADER */
        .game-header {
            width: 800px; background: white; border: 5px solid var(--byu-blue);
            display: flex; flex-direction: column; margin-bottom: 10px;
        }
        .header-top {
            background: var(--byu-blue); color: white; padding: 12px;
            text-align: center; font-size: 36px; letter-spacing: 2px;
        }
        .header-stats {
            display: flex; border-top: 5px solid var(--byu-blue); height: 60px;
        }
        .stat-segment {
            flex: 1; display: flex; align-items: center; justify-content: center;
            border-right: 5px solid var(--byu-blue); padding: 0 20px; font-size: 20px;
        }
        .milk-meter {
            width: 140px; height: 18px; background: #eee; border: 2px solid var(--byu-blue);
            margin-left: 10px; overflow: hidden;
        }
        #milk-bar { width: 0%; height: 100%; background: var(--gold); }

        #game-box {
            position: relative; border: 8px solid var(--byu-blue); background: #87CEEB;
            box-shadow: 0 20px 60px rgba(0,46,93,0.3);
        }
        .game-over-panel {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); color: white; display: none;
            flex-direction: column; align-items: center; justify-content: center; z-index: 1000;
        }
        .restart-btn {
            background: white; color: var(--byu-blue); border: none; padding: 15px 40px;
            font-family: 'Bungee'; font-size: 24px; cursor: pointer; margin-top: 25px;
        }
    </style>
</head>
<body>

    <div class="game-header">
        <div class="header-top">COUGAR RUN <span style="opacity:0.5; font-weight:100;">|</span> THE PROVO TRIALS</div>
        <div class="header-stats">
            <div class="stat-segment">MILK POWER <div class="milk-meter"><div id="milk-bar"></div></div></div>
            <div class="stat-segment" style="border:none">YARDS: <span id="score">0</span></div>
        </div>
    </div>

    <div id="game-box">
        <div id="gameOver" class="game-over-panel">
            <h1 style="font-size: 70px; margin: 0; color: #ff4444;">FUMBLED!</h1>
            <p style="font-size: 24px;">TOTAL YARDS: <span id="finalScore">0</span></p>
            <button class="restart-btn" onclick="resetGame()">REPLAY RUN</button>
        </div>
        <canvas id="gameCanvas" width="800" height="500"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let state = {
            active: true, score: 0, lane: 1, vLane: 1,
            jumpY: 0, jumpVel: 0, isJumping: false,
            milk: 0, speed: 0.022, frame: 0, obstacles: []
        };

        // --- ART ENGINE: PROCEDURAL MASCOTS ---
        function drawDetailedCosmo(x, y, s) {
            ctx.save();
            ctx.translate(x, y - state.jumpY);
            ctx.scale(s, s);

            if (state.milk > 0) ctx.filter = "drop-shadow(0 0 15px gold) brightness(1.2)";

            // Ears
            ctx.fillStyle = "#D2B48C";
            ctx.beginPath(); ctx.ellipse(-18, -75, 8, 12, -0.4, 0, 7); ctx.fill();
            ctx.beginPath(); ctx.ellipse(18, -75, 8, 12, 0.4, 0, 7); ctx.fill();

            // Head (Round & Fluffy)
            ctx.beginPath(); ctx.arc(0, -60, 28, 0, Math.PI*2); ctx.fill();
            
            // Muzzle (The white part)
            ctx.fillStyle = "#F5DEB3";
            ctx.beginPath(); ctx.ellipse(0, -52, 18, 12, 0, 0, Math.PI*2); ctx.fill();

            // Eyes (Big & Cartoonish)
            ctx.fillStyle = "white";
            ctx.beginPath(); ctx.arc(-10, -65, 6, 0, 7); ctx.fill();
            ctx.beginPath(); ctx.arc(10, -65, 6, 0, 7); ctx.fill();
            ctx.fillStyle = "black";
            ctx.beginPath(); ctx.arc(-10, -65, 3, 0, 7); ctx.fill();
            ctx.beginPath(); ctx.arc(10, -65, 3, 0, 7); ctx.fill();

            // Nose (Pink & Cute)
            ctx.fillStyle = "#FFB6C1";
            ctx.beginPath(); ctx.arc(0, -55, 4, 0, 7); ctx.fill();

            // Jersey (With 00)
            ctx.fillStyle = "#002E5D";
            ctx.beginPath(); ctx.roundRect(-25, -40, 50, 40, 8); ctx.fill();
            ctx.fillStyle = "white"; ctx.font = "bold 22px Oswald"; ctx.textAlign="center";
            ctx.fillText("00", 0, -12);

            // Paws/Legs
            ctx.fillStyle = "#D2B48C";
            let legH = Math.sin(state.frame * 0.25) * 15;
            ctx.beginPath(); ctx.ellipse(-12, -5 + legH, 10, 15, 0, 0, 7); ctx.fill();
            ctx.beginPath(); ctx.ellipse(12, -5 - legH, 10, 15, 0, 0, 7); ctx.fill();

            ctx.restore();
        }

        function drawRivalMascot(x, y, s, type) {
            ctx.save(); ctx.translate(x, y); ctx.scale(s, s);
            const colors = ["#cc0000", "#4b2e83", "#0051ba"]; // Utah, KState, KU
            const labels = ["U", "W", "K"];
            
            ctx.fillStyle = colors[type];
            ctx.beginPath(); ctx.arc(0, -60, 25, 0, 7); ctx.fill(); // Head
            ctx.beginPath(); ctx.roundRect(-22, -40, 44, 40, 5); ctx.fill(); // Body
            
            ctx.fillStyle = "white"; ctx.font = "bold 18px Arial"; ctx.textAlign="center";
            ctx.fillText(labels[type], 0, -55);
            ctx.restore();
        }

        function drawMilkCarton(x, y, s) {
            ctx.save(); ctx.translate(x, y); ctx.scale(s, s);
            ctx.fillStyle = "white"; ctx.beginPath(); ctx.moveTo(-15, 0); ctx.lineTo(-15, -35); ctx.lineTo(0, -50); ctx.lineTo(15, -35); ctx.lineTo(15, 0); ctx.fill();
            ctx.fillStyle = "#0062B8"; ctx.fillRect(-15, -30, 30, 12);
            ctx.fillStyle = "white"; ctx.font = "bold 10px Arial"; ctx.fillText("MILK", -12, -21);
            ctx.restore();
        }

        function drawStadium() {
            // Sky
            ctx.fillStyle = "#B3E5FC"; ctx.fillRect(0, 0, 800, 250);
            
            // Timp
            ctx.fillStyle = "#CFD8DC";
            ctx.beginPath(); ctx.moveTo(0, 250); ctx.lineTo(150, 60); ctx.lineTo(350, 180); ctx.lineTo(550, 40); ctx.lineTo(800, 250); ctx.fill();
            ctx.fillStyle = "#002E5D"; ctx.font = "bold 30px serif"; ctx.fillText("Y", 530, 100);

            // Stadium Seats (Gray Gradient)
            ctx.fillStyle = "#90A4AE";
            ctx.fillRect(0, 250, 800, 80);
            for(let i=0; i<800; i+=40) { ctx.fillStyle="#78909C"; ctx.fillRect(i, 250, 2, 80); }

            // Field
            ctx.fillStyle = "#66BB6A"; ctx.fillRect(0, 330, 800, 170);
            
            // Perspective Road
            ctx.fillStyle = "#455A64";
            ctx.beginPath(); ctx.moveTo(385, 330); ctx.lineTo(415, 330); ctx.lineTo(800, 500); ctx.lineTo(0, 500); ctx.fill();
            
            // White Side Lines
            ctx.strokeStyle = "white"; ctx.lineWidth = 6;
            ctx.beginPath(); ctx.moveTo(385, 330); ctx.lineTo(0, 500); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(415, 330); ctx.lineTo(800, 500); ctx.stroke();

            // Floodlights
            ctx.fillStyle = "#37474F";
            ctx.fillRect(50, 100, 10, 150); ctx.fillRect(20, 80, 70, 40);
            ctx.fillRect(740, 100, 10, 150); ctx.fillRect(710, 80, 70, 40);
        }

        function update() {
            if (!state.active) return;
            state.frame++;
            if (state.milk > 0) state.milk--;
            document.getElementById('milk-bar').style.width = (state.milk / 2) + "%";

            ctx.clearRect(0,0,800,500);
            drawStadium();

            state.vLane += (state.lane - state.vLane) * 0.18;
            if (state.isJumping) {
                state.jumpY += state.jumpVel; state.jumpVel -= 1.3;
                if (state.jumpY <= 0) { state.jumpY = 0; state.isJumping = false; }
            }

            if (state.frame % 35 === 0) {
                let isMilk = Math.random() < 0.12;
                state.obstacles.push({ z: 0, lane: Math.floor(Math.random()*3), type: isMilk ? 'milk' : 'rival' });
            }

            for (let i = state.obstacles.length - 1; i >= 0; i--) {
                let o = state.obstacles[i]; o.z += state.speed;
                let s = o.z * 5;
                let sy = 330 + (o.z * 170);
                let sx = 400 + (o.lane - 1) * (o.z * 480);

                if (o.type === 'milk') drawMilkCarton(sx, sy, s);
                else drawRivalMascot(sx, sy, s, i % 3);

                if (o.z > 0.82 && o.z < 1.0) {
                    if (o.lane === state.lane && state.jumpY < 45) {
                        if (o.type === 'milk') { state.milk = 200; state.obstacles.splice(i, 1); }
                        else if (state.milk <= 0) endGame();
                    }
                }
                if (o.z > 1.2) { state.obstacles.splice(i, 1); state.score += 10; state.speed += 0.00015; }
            }

            drawDetailedCosmo(120 + (state.vLane * 280), 485, 1.3);
            document.getElementById('score').innerText = state.score;
            requestAnimationFrame(update);
        }

        function endGame() { state.active = false; document.getElementById('gameOver').style.display='flex'; document.getElementById('finalScore').innerText = state.score; }
        function resetGame() { state = {...state, active:true, score:0, obstacles:[], speed:0.022, lane:1, milk:0}; document.getElementById('gameOver').style.display='none'; update(); }
        window.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && state.lane > 0) state.lane--;
            if (e.key === 'ArrowRight' && state.lane < 2) state.lane++;
            if (e.key === 'ArrowUp' && !state.isJumping) { state.isJumping = true; state.jumpVel = 20; }
        });
        update();
    </script>
</body>
</html>